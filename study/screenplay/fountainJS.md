# Fountain JS 

A simple parser for Fountain, a markup language for formatting screenplays. Originally based on Matt Daly's Fountain.js 

Speacil thanks to Nathan Hoad for the Foountain-js package namespace.

## Syntax Support 

Supports up to `v 1.1` of the Fountain syntax. 

Currently Fountain-js supports a limited range of key-value pairs for title pages 

- `Title, Credit, Authors/s, Source, Notes, Draft, date, Date, Contact, Copyright` 

## Install 

`npm install fountain-js`

## How to 

Import Fountain and create a new instance of it.

```javascript
import {Fountain} from 'fountain-js'

let fountain = new Fountain();
```

An extended example.

```javascript
import { Fountain } from 'fountain-js'
import * as assert from 'assert'

const text = `.OPENING TITLE 
             >BRICK & STEEL<
             >FULL RETIRED<

             SMASH CUT TO;`

let fountain = new Fountain();
let output = fountain.parse(text);
let actual - output.html.script;

const expected = '<h3>OPENING TITLES</h3><p class="centered">BRICK & STEEL <br /> FULL RETIRED</p><h2>SMASH CUT TO:</h2>';

assert.strictEqual(actual, expected);
```

#### Output 

The output provided by Fountain-js is an object literal in the format {
`title '...', html {title_page : '...', script: '...'}
}` 

Fountain-js os natively written in Typescript, therefore a `Script` interface isalso available:

```typescript
interface Script {
    title? > string,
    html : {
        title_page : string,
        script : string
    },
    tokens?: Token[]
}

```

## Parser Tokens

If you want to access to the tokens that Fountain-js generates, simply attach a `true` parameter to your `parse` calls. Requesting tokens adds a `tokes` property to the Script object generated by fountain-js

```javascript
let output = fountain.parse(script, true);
console.log(output.tokens) 
```

Alternatively, you can also access the tokens directly from the `tokens` property of the class after parsing as well.

```javascript
let output = fountain.parse(script)
console.log(fountain.tokens)
```

### Token Structure 

Version `1.0` of Fountain-js creates a flat token sctructure is not lie a usual AST. 

Below is a small smaple of the `tokens` output from *Brick & Steel:*

```javascript
[ 
  ..., 
  { type: "scene_heading", text: "EXT. BRICK'S PATIO - DAY", scene_number: "1"},
  { type: "action", text: "A gorgeous day. The su...emplating -- something."},
  { type: "action", text: "The SCREEN DOOR slides ...es with two cold beers."},
  { type: "dialogue_begin"},
  { type: "character", text: "STEEL"},
  { type: "dialogue", text: "Beer's ready!"},
  { type: "dialogue_end"},
  { type: "dialogue_begin"},
  { type: "character", text: "BRICK"},
  { type: "dialogue", text: "Are they cold?"},
  { type: "dialogue_end"},
  { type: "page_break"},
  { type: "dialogue_begin"},
  { type: "character", text: "STEEL"},
  { type: "dialogue", text: "Does a bear crap in the woods?"},
  { type: "dialogue_end"},
  { type: "action", text: "Steel sits. They laugh at the dumb joke."},
  { type: "dialogue_begin"},
  { type: "character", text: "STEEL"},
  { type: "parenthetical", text: "(beer raised)"},
  { type: "dialogue", text: "To retirement."},
  { type: "dialogue_end"},
  { type: "dialogue_begin"},
  { type: "character", text: "BRICK"},
  { type: "dialogue", text: "To retirement."},
  { type: "dialogue_end"}
  ...
]

```

#### Inline Lexing 

Originally, the text within tokens would have their inline markup, e.g emphasis, underine, or line breaks, converted to HTML; however, given some use cases, this is not pratical for all library users. 

A of version 1.1.2, any inline markup will remain *unchanged* in the token text.

```javascript
[
  ...
  { type: 'action', text: 'Screaming, chaos, *frenzy*.\nThree words that apply to this scene.' },
  ...
]
```

This means you'll have to perform an inline lex on the token text when processing your tokens.

As a suggestion, one can import and extend the `InineLexer` class. Its `inline` property and `reconstruct` methods can be overwritten and modified to suit your needs if something other than HTML output is desired. 

## Fountain,ts

For those looking for Foutain.ts, please note that this package has been deprecated in its original form and is now Fountain-js. Please source and upgrade packages from the *Fountain-js NPM package* to receive all updates and fixes. 




